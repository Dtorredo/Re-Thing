let e;import{createRequire as t}from"module";let r=t(import.meta.url);var n,o,a,s,i,l,u,f,c,p,d,y,m,h,g,w,b,v,E,O,C,_,T,A,x,L,R,$,S,U,P,N,I,M,k,j,F,B,W,G,V,D,z,H,Z,q,J,K,Q=Object.defineProperty,X=Object.getOwnPropertyDescriptor,Y=Object.getOwnPropertyNames,ee=Object.prototype.hasOwnProperty,et=(e=function(e){if("u">typeof r)return r.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},"u">typeof r?r:"u">typeof Proxy?new Proxy(e,{get:(e,t)=>("u">typeof r?r:e)[t]}):e),er=(e,t)=>()=>(e&&(t=e(e=0)),t),en=er(()=>{"use strict";n=!!("u">typeof process&&process.versions&&process.versions.node)}),eo=er(()=>{"use strict";en(),o=n||typeof location>"u"?void 0:location.origin,a=(()=>{if(!n)return import.meta.url?.startsWith("file:")?new URL(new URL("ort.node.min.mjs",import.meta.url).href,o).href:import.meta.url})(),s=()=>{if(a&&!a.startsWith("blob:"))return a.substring(0,a.lastIndexOf("/")+1)},i=(e,t)=>{try{let r=t??a;return(r?new URL(e,r):new URL(e)).origin===o}catch{return!1}},l=(e,t)=>{let r=t??a;try{return(r?new URL(e,r):new URL(e)).href}catch{return}},u=(e,t)=>`${t??"./"}${e}`,f=async e=>{let t=await (await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},c=async e=>(await import(e)).default,p=void 0,d=async(e,t,r)=>{if(!e&&!t&&p&&a&&i(a))return[void 0,p];{let o="ort-wasm-simd-threaded.mjs",a=e??l(o,t),s=!n&&r&&a&&!i(a,t),p=s?await f(a):a??u(o,t);return[s?p:void 0,await c(p)]}}}),ea=er(()=>{"use strict";eo(),m=!1,h=!1,g=!1,w=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return"u">typeof MessageChannel&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},b=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},v=async e=>{if(m)return Promise.resolve();if(h)throw Error("multiple calls to 'initializeWebAssembly()' detected.");if(g)throw Error("previous call to 'initializeWebAssembly()' failed.");h=!0;let t=e.initTimeout,r=e.numThreads;if(!b())throw Error("WebAssembly SIMD is not supported in the current environment.");let n=w();r>1&&!n&&("u">typeof self&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+r+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=r=1);let o=e.wasmPaths,a="string"==typeof o?o:void 0,i=o?.mjs,l=i?.href??i,u=o?.wasm,f=u?.href??u,c=e.wasmBinary,[p,v]=await d(l,a,r>1),E=!1,O=[];if(t>0&&O.push(new Promise(e=>{setTimeout(()=>{E=!0,e()},t)})),O.push(new Promise((e,t)=>{let n={numThreads:r};if(c)n.wasmBinary=c;else if(f||a)n.locateFile=e=>f??a+e;else if(l&&0!==l.indexOf("blob:"))n.locateFile=e=>new URL(e,l).href;else if(p){let e=s();e&&(n.locateFile=t=>e+t)}v(n).then(t=>{h=!1,m=!0,y=t,e(),p&&URL.revokeObjectURL(p)},e=>{h=!1,g=!0,t(e)})})),await Promise.race(O),E)throw Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},E=()=>{if(m&&y)return y;throw Error("WebAssembly is not initialized yet.")}}),es=er(()=>{"use strict";ea(),O=(e,t)=>{let r=E(),n=r.lengthBytesUTF8(e)+1,o=r._malloc(n);return r.stringToUTF8(e,o,n),t.push(o),o},C=(e,t,r,n)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([e,o])=>{let a=t?t+e:e;if("object"==typeof o)C(o,a+".",r,n);else if("string"==typeof o||"number"==typeof o)n(a,o.toString());else if("boolean"==typeof o)n(a,o?"1":"0");else throw Error(`Can't handle extra config type: ${typeof o}`)})},_=e=>{let t=E(),r=t.stackSave();try{let r=t.PTR_SIZE,n=t.stackAlloc(2*r);t._OrtGetLastError(n,n+r);let o=Number(t.getValue(n,4===r?"i32":"i64")),a=t.getValue(n+r,"*"),s=a?t.UTF8ToString(a):"";throw Error(`${e} ERROR_CODE: ${o}, ERROR_MESSAGE: ${s}`)}finally{t.stackRestore(r)}}}),ei=er(()=>{"use strict";ea(),es(),T=e=>{let t=E(),r=0,n=[],o=e||{};try{if(e?.logSeverityLevel===void 0)o.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)o.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(o.terminate=!1);let a=0;return e?.tag!==void 0&&(a=O(e.tag,n)),r=t._OrtCreateRunOptions(o.logSeverityLevel,o.logVerbosityLevel,!!o.terminate,a),0===r&&_("Can't create run options."),e?.extra!==void 0&&C(e.extra,"",new WeakSet,(e,o)=>{let a=O(e,n),s=O(o,n);0!==t._OrtAddRunConfigEntry(r,a,s)&&_(`Can't set a run config entry: ${e} - ${o}.`)}),[r,n]}catch(e){throw 0!==r&&t._OrtReleaseRunOptions(r),n.forEach(e=>t._free(e)),e}}}),el=er(()=>{"use strict";ea(),es(),A=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw Error(`unsupported graph optimization level: ${e}`)}},x=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw Error(`unsupported execution mode: ${e}`)}},L=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(e=>("string"==typeof e?e:e.name)==="webgpu")&&(e.enableMemPattern=!1)},R=(e,t,r)=>{for(let n of t){let t="string"==typeof n?n:n.name;switch(t){case"webnn":if(t="WEBNN","string"!=typeof n){let t=n?.deviceType;if(t){let n=O("deviceType",r),o=O(t,r);0!==E()._OrtAddSessionConfigEntry(e,n,o)&&_(`Can't set a session config entry: 'deviceType' - ${t}.`)}}break;case"webgpu":if(t="JS","string"!=typeof n&&n?.preferredLayout){if("NCHW"!==n.preferredLayout&&"NHWC"!==n.preferredLayout)throw Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${n.preferredLayout}`);let t=O("preferredLayout",r),o=O(n.preferredLayout,r);0!==E()._OrtAddSessionConfigEntry(e,t,o)&&_(`Can't set a session config entry: 'preferredLayout' - ${n.preferredLayout}.`)}break;case"wasm":case"cpu":continue;default:throw Error(`not supported execution provider: ${t}`)}let o=O(t,r);0!==E()._OrtAppendExecutionProvider(e,o)&&_(`Can't append execution provider: ${t}.`)}},$=e=>{let t=E(),r=0,n=[],o=e||{};L(o);try{let e=A(o.graphOptimizationLevel??"all"),a=x(o.executionMode??"sequential"),s="string"==typeof o.logId?O(o.logId,n):0,i=o.logSeverityLevel??2;if(!Number.isInteger(i)||i<0||i>4)throw Error(`log serverity level is not valid: ${i}`);let l=o.logVerbosityLevel??0;if(!Number.isInteger(l)||l<0||l>4)throw Error(`log verbosity level is not valid: ${l}`);let u="string"==typeof o.optimizedModelFilePath?O(o.optimizedModelFilePath,n):0;if(r=t._OrtCreateSessionOptions(e,!!o.enableCpuMemArena,!!o.enableMemPattern,a,!!o.enableProfiling,0,s,i,l,u),0===r&&_("Can't create session options."),o.executionProviders&&R(r,o.executionProviders,n),void 0!==o.enableGraphCapture){if("boolean"!=typeof o.enableGraphCapture)throw Error(`enableGraphCapture must be a boolean value: ${o.enableGraphCapture}`);let e=O("enableGraphCapture",n),a=O(o.enableGraphCapture.toString(),n);0!==t._OrtAddSessionConfigEntry(r,e,a)&&_(`Can't set a session config entry: 'enableGraphCapture' - ${o.enableGraphCapture}.`)}if(o.freeDimensionOverrides)for(let[e,a]of Object.entries(o.freeDimensionOverrides)){if("string"!=typeof e)throw Error(`free dimension override name must be a string: ${e}`);if("number"!=typeof a||!Number.isInteger(a)||a<0)throw Error(`free dimension override value must be a non-negative integer: ${a}`);let o=O(e,n);0!==t._OrtAddFreeDimensionOverride(r,o,a)&&_(`Can't set a free dimension override: ${e} - ${a}.`)}return void 0!==o.extra&&C(o.extra,"",new WeakSet,(e,o)=>{let a=O(e,n),s=O(o,n);0!==t._OrtAddSessionConfigEntry(r,a,s)&&_(`Can't set a session config entry: ${e} - ${o}.`)}),[r,n]}catch(e){throw 0!==r&&0!==t._OrtReleaseSessionOptions(r)&&_("Can't release session options."),n.forEach(e=>t._free(e)),e}}}),eu=er(()=>{"use strict";S=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw Error(`unsupported data type: ${e}`)}},U=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw Error(`unsupported data type: ${e}`)}},P=(e,t)=>{let r=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],n="number"==typeof t?t:t.reduce((e,t)=>e*t,1);return r>0?Math.ceil(n*r):void 0},N=e=>{switch(e){case"float16":return"u">typeof Float16Array&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw Error(`unsupported type: ${e}`)}},I=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw Error(`unsupported logging level: ${e}`)}},M=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,k=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint64"===e||"int8"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,j=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw Error(`unsupported data location: ${e}`)}}}),ef=er(()=>{"use strict";en(),F=async e=>{if("string"!=typeof e)return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e);if(n)try{let{readFile:t}=et("node:fs/promises");return new Uint8Array(await t(e))}catch(t){if("ERR_FS_FILE_TOO_LARGE"===t.code){let{createReadStream:t}=et("node:fs"),r=t(e),n=[];for await(let e of r)n.push(e);return new Uint8Array(Buffer.concat(n))}throw t}else{let t=await fetch(e);if(!t.ok)throw Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),n=r?parseInt(r,10):0;if(n<0x40000000)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw Error(`failed to load external data file: ${e}, no response body.`);let r=t.body.getReader(),o;try{o=new ArrayBuffer(n)}catch(e){if(e instanceof RangeError){let e=Math.ceil(n/65536);o=new WebAssembly.Memory({initial:e,maximum:e}).buffer}else throw e}let a=0;for(;;){let{done:e,value:t}=await r.read();if(e)break;let n=t.byteLength;new Uint8Array(o,a,n).set(t),a+=n}return new Uint8Array(o,0,n)}}}}),ec=er(()=>{"use strict";ei(),el(),eu(),ea(),es(),ef(),B=(e,t)=>{0!==E()._OrtInit(e,t)&&_("Can't initialize onnxruntime.")},W=async e=>{B(e.wasm.numThreads,I(e.logLevel))},G=async(e,t)=>{},V=new Map,D=e=>{let t=E(),r=t.stackSave();try{let r=t.PTR_SIZE,n=t.stackAlloc(2*r);0!==t._OrtGetInputOutputCount(e,n,n+r)&&_("Can't get session input/output count.");let o=4===r?"i32":"i64";return[Number(t.getValue(n,o)),Number(t.getValue(n+r,o))]}finally{t.stackRestore(r)}},z=e=>{let t=E(),r=t._malloc(e.byteLength);if(0===r)throw Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},H=async(e,t)=>{let r,n,o=E();Array.isArray(e)?[r,n]=e:e.buffer===o.HEAPU8.buffer?[r,n]=[e.byteOffset,e.byteLength]:[r,n]=z(e);let a=0,s=0,i=[],l=[],u=[];try{if([s,i]=$(t),t?.externalData&&o.mountExternalData){let e=[];for(let r of t.externalData){let t="string"==typeof r?r:r.path;e.push(F("string"==typeof r?r:r.data).then(e=>{o.mountExternalData(t,e)}))}await Promise.all(e)}for(let e of t?.executionProviders??[])if(("string"==typeof e?e:e.name)==="webnn"){if(o.shouldTransferToMLTensor=!1,"string"!=typeof e){let t=e?.context,r=e?.gpuDevice,n=e?.deviceType,a=e?.powerPreference;t?o.currentContext=t:r?o.currentContext=await o.jsepCreateMLContext(r):o.currentContext=await o.jsepCreateMLContext({deviceType:n,powerPreference:a})}else o.currentContext=await o.jsepCreateMLContext();break}a=await o._OrtCreateSession(r,n,s),0===a&&_("Can't create a session."),o.jsepOnCreateSession?.(),o.currentContext&&(o.jsepRegisterMLContext(a,o.currentContext),o.currentContext=void 0,o.shouldTransferToMLTensor=!0);let[e,f]=D(a),c=!!t?.enableGraphCapture,p=[],d=[];for(let t=0;t<e;t++){let e=o._OrtGetInputName(a,t);0===e&&_("Can't get an input name."),l.push(e),p.push(o.UTF8ToString(e))}for(let e=0;e<f;e++){let t=o._OrtGetOutputName(a,e);0===t&&_("Can't get an output name."),u.push(t);let r=o.UTF8ToString(t);d.push(r)}return V.set(a,[a,l,u,null,c,!1]),[a,p,d]}catch(e){throw l.forEach(e=>o._OrtFree(e)),u.forEach(e=>o._OrtFree(e)),0!==a&&0!==o._OrtReleaseSession(a)&&_("Can't release session."),e}finally{o._free(r),0!==s&&0!==o._OrtReleaseSessionOptions(s)&&_("Can't release session options."),i.forEach(e=>o._free(e)),o.unmountExternalData?.()}},Z=e=>{let t=E(),r=V.get(e);if(!r)throw Error(`cannot release session. invalid session id: ${e}`);let[n,o,a,s,i]=r;s&&(i&&0!==t._OrtClearBoundOutputs(s.handle)&&_("Can't clear bound outputs."),0!==t._OrtReleaseBinding(s.handle)&&_("Can't release IO binding.")),t.jsepOnReleaseSession?.(e),o.forEach(e=>t._OrtFree(e)),a.forEach(e=>t._OrtFree(e)),0!==t._OrtReleaseSession(n)&&_("Can't release session."),V.delete(e)},q=(e,t,r,n,o,a=!1)=>{if(!e){t.push(0);return}let s=E(),i=s.PTR_SIZE,l=e[0],u=e[1],f=e[3],c,p;if("string"===l&&("gpu-buffer"===f||"ml-tensor"===f))throw Error("String tensor is not supported on GPU.");if(a&&"gpu-buffer"!==f)throw Error(`External buffer must be provided for input/output index ${o} when enableGraphCapture is true.`);if("gpu-buffer"===f){let t=e[2].gpuBuffer;p=P(S(l),u);let r=s.jsepRegisterBuffer;if(!r)throw Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');c=r(n,o,t,p)}else if("ml-tensor"===f){let t=e[2].mlTensor;p=P(S(l),u);let r=s.jsepRegisterMLTensor;if(!r)throw Error('Tensor location "ml-tensor" is not supported without using WebNN.');c=r(t,S(l),u)}else{let t=e[2];if(Array.isArray(t)){p=i*t.length,c=s._malloc(p),r.push(c);for(let e=0;e<t.length;e++){if("string"!=typeof t[e])throw TypeError(`tensor data at index ${e} is not a string`);s.setValue(c+e*i,O(t[e],r),"*")}}else p=t.byteLength,c=s._malloc(p),r.push(c),s.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,p),c)}let d=s.stackSave(),y=s.stackAlloc(4*u.length);try{u.forEach((e,t)=>s.setValue(y+t*i,e,4===i?"i32":"i64"));let e=s._OrtCreateTensor(S(l),c,p,y,u.length,j(f));0===e&&_(`Can't create tensor for input/output. session=${n}, index=${o}.`),t.push(e)}finally{s.stackRestore(d)}},J=async(e,t,r,n,o,a)=>{let s=E(),i=s.PTR_SIZE,l=V.get(e);if(!l)throw Error(`cannot run inference. invalid session id: ${e}`);let u=l[0],f=l[1],c=l[2],p=l[3],d=l[4],y=(l[5],t.length),m=n.length,h=0,g=[],w=[],b=[],v=[],O=s.stackSave(),C=s.stackAlloc(y*i),A=s.stackAlloc(y*i),x=s.stackAlloc(m*i),L=s.stackAlloc(m*i);try{let l;s.jsepOnRunStart?.(u),[h,g]=T(a);for(let n=0;n<y;n++)q(r[n],w,v,e,t[n],d);for(let t=0;t<m;t++)q(o[t],b,v,e,y+n[t],d);for(let e=0;e<y;e++)s.setValue(C+e*i,w[e],"*"),s.setValue(A+e*i,f[t[e]],"*");for(let e=0;e<m;e++)s.setValue(x+e*i,b[e],"*"),s.setValue(L+e*i,c[n[e]],"*");l=await s._OrtRun(u,A,C,y,L,m,x,h),0!==l&&_("failed to call OrtRun().");let E=[];for(let e=0;e<m;e++){let t=Number(s.getValue(x+e*i,"*"));if(t===b[e]){E.push(o[e]);continue}let r=s.stackSave(),a=s.stackAlloc(4*i),l=!1,u,f=0;try{0!==s._OrtGetTensorData(t,a,a+i,a+2*i,a+3*i)&&_(`Can't access output tensor data on index ${e}.`);let r=4===i?"i32":"i64",o=Number(s.getValue(a,r));f=s.getValue(a+i,"*");let c=s.getValue(a+2*i,"*"),d=Number(s.getValue(a+3*i,r)),y=[];for(let e=0;e<d;e++)y.push(Number(s.getValue(c+e*i,r)));0!==s._OrtFree(c)&&_("Can't free memory for tensor dims.");let m=y.reduce((e,t)=>e*t,1);u=U(o);let h=p?.outputPreferredLocations[n[e]];if("string"===u){if("gpu-buffer"===h||"ml-tensor"===h)throw Error("String tensor is not supported on GPU.");let e=[];for(let t=0;t<m;t++){let r=s.getValue(f+t*i,"*"),n=s.getValue(f+(t+1)*i,"*"),o=t===m-1?void 0:n-r;e.push(s.UTF8ToString(r,o))}E.push([u,y,e,"cpu"])}else if("gpu-buffer"===h&&m>0){let e=s.jsepGetBuffer;if(!e)throw Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let r=e(f),n=P(o,m);if(void 0===n||!M(u))throw Error(`Unsupported data type: ${u}`);l=!0,E.push([u,y,{gpuBuffer:r,download:s.jsepCreateDownloader(r,n,u),dispose:()=>{0!==s._OrtReleaseTensor(t)&&_("Can't release tensor.")}},"gpu-buffer"])}else if("ml-tensor"===h&&m>0){let e=s.jsepEnsureTensor;if(!e)throw Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(void 0===P(o,m)||!k(u))throw Error(`Unsupported data type: ${u}`);let r=await e(f,o,y,!1);l=!0,E.push([u,y,{mlTensor:r,download:s.jsepCreateMLTensorDownloader(f,u),dispose:()=>{s.jsepReleaseTensorId(f),s._OrtReleaseTensor(t)}},"ml-tensor"])}else{let e=new(N(u))(m);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(s.HEAPU8.subarray(f,f+e.byteLength)),E.push([u,y,e,"cpu"])}}finally{s.stackRestore(r),"string"===u&&f&&s._free(f),l||s._OrtReleaseTensor(t)}}return p&&!d&&(0!==s._OrtClearBoundOutputs(p.handle)&&_("Can't clear bound outputs."),V.set(e,[u,f,c,p,d,!1])),E}finally{s.stackRestore(O),w.forEach(e=>s._OrtReleaseTensor(e)),b.forEach(e=>s._OrtReleaseTensor(e)),v.forEach(e=>s._free(e)),0!==h&&s._OrtReleaseRunOptions(h),g.forEach(e=>s._free(e))}},K=e=>{let t=E(),r=V.get(e);if(!r)throw Error("invalid session id");let n=r[0],o=t._OrtEndProfiling(n);0===o&&_("Can't get an profile file name."),t._OrtFree(o)}});import{env as ep}from"onnxruntime-common";var ed,ey,em,eh,eg,ew,eb,ev,eE,eO,eC=er(()=>{"use strict";ec(),ea(),eo(),ed=!1,ey=!1,em=!1,eh=async()=>{if(!ey){if(ed)throw Error("multiple calls to 'initWasm()' detected.");if(em)throw Error("previous call to 'initWasm()' failed.");ed=!0;try{await v(ep.wasm),await W(ep),ey=!0}catch(e){throw em=!0,e}finally{ed=!1}}},eg=async e=>{await G(ep,e)},ew=async e=>z(e),eb=async(e,t)=>H(e,t),ev=async e=>{Z(e)},eE=async(e,t,r,n,o,a)=>J(e,t,r,n,o,a),eO=async e=>{K(e)}});import{Tensor as e_,TRACE_FUNC_BEGIN as eT,TRACE_FUNC_END as eA}from"onnxruntime-common";var ex,eL,eR,e$=er(()=>{"use strict";eC(),eu(),en(),ef(),ex=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw Error(`invalid data location: ${e.location} for ${t()}`)}},eL=e=>{switch(e[3]){case"cpu":return new e_(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!M(t))throw Error(`not supported data type: ${t} for deserializing GPU tensor`);let{gpuBuffer:r,download:n,dispose:o}=e[2];return e_.fromGpuBuffer(r,{dataType:t,dims:e[1],download:n,dispose:o})}case"ml-tensor":{let t=e[0];if(!k(t))throw Error(`not supported data type: ${t} for deserializing MLTensor tensor`);let{mlTensor:r,download:n,dispose:o}=e[2];return e_.fromMLTensor(r,{dataType:t,dims:e[1],download:n,dispose:o})}default:throw Error(`invalid data location: ${e[3]}`)}},eR=class{async fetchModelAndCopyToWasmMemory(e){return ew(await F(e))}async loadModel(e,t){let r;eT(),r="string"==typeof e?n?await F(e):await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames]=await eb(r,t),eA()}async dispose(){return ev(this.sessionId)}async run(e,t,r){eT();let n=[],o=[];Object.entries(e).forEach(e=>{let t=e[0],r=e[1],a=this.inputNames.indexOf(t);if(-1===a)throw Error(`invalid input '${t}'`);n.push(r),o.push(a)});let a=[],s=[];Object.entries(t).forEach(e=>{let t=e[0],r=e[1],n=this.outputNames.indexOf(t);if(-1===n)throw Error(`invalid output '${t}'`);a.push(r),s.push(n)});let i=n.map((e,t)=>ex(e,()=>`input "${this.inputNames[o[t]]}"`)),l=a.map((e,t)=>e?ex(e,()=>`output "${this.outputNames[s[t]]}"`):null),u=await eE(this.sessionId,o,i,s,l,r),f={};for(let e=0;e<u.length;e++)f[this.outputNames[s[e]]]=a[e]??eL(u[e]);return eA(),f}startProfiling(){}endProfiling(){eO(this.sessionId)}}}),eS={};((e,t)=>{for(var r in t)Q(e,r,{get:t[r],enumerable:!0})})(eS,{OnnxruntimeWebAssemblyBackend:()=>eN,initializeFlags:()=>eP,wasmBackend:()=>eI});import{env as eU}from"onnxruntime-common";var eP,eN,eI,eM=er(()=>{"use strict";eC(),e$(),eP=()=>{if(("number"!=typeof eU.wasm.initTimeout||eU.wasm.initTimeout<0)&&(eU.wasm.initTimeout=0),!1===eU.wasm.simd&&console.warn('Deprecated property "env.wasm.simd" is set to false. non-SIMD build is no longer provided, and this setting will be ignored.'),"boolean"!=typeof eU.wasm.proxy&&(eU.wasm.proxy=!1),"boolean"!=typeof eU.wasm.trace&&(eU.wasm.trace=!1),"number"!=typeof eU.wasm.numThreads||!Number.isInteger(eU.wasm.numThreads)||eU.wasm.numThreads<=0){if("u">typeof self&&!self.crossOriginIsolated)eU.wasm.numThreads=1;else{let e=typeof navigator>"u"?et("node:os").cpus().length:navigator.hardwareConcurrency;eU.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}}},eI=new(eN=class{async init(e){eP(),await eh(),await eg(e)}async createInferenceSessionHandler(e,t){let r=new eR;return await r.loadModel(e,t),Promise.resolve(r)}})});export*from"onnxruntime-common";import*as ek from"onnxruntime-common";import{registerBackend as ej,env as eF}from"onnxruntime-common";var eB=ek;{let e=(eM(),((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of Y(t))ee.call(e,o)||o===r||Q(e,o,{get:()=>t[o],enumerable:!(n=X(t,o))||n.enumerable});return e})(Q({},"__esModule",{value:!0}),eS)).wasmBackend;ej("cpu",e,10),ej("wasm",e,10)}Object.defineProperty(eF.versions,"web",{value:"1.21.0-dev.20250206-d981b153d3",enumerable:!0});export{eB as default};